C51 COMPILER V8.06   LCD                                                                   01/17/2018 09:09:21 PAGE 1   


C51 COMPILER V8.06, COMPILATION OF MODULE LCD
OBJECT MODULE PLACED IN LCD.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE LCD.c OPTIMIZE(9,SIZE) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include"head.h"
   2          
   3          uchar seg[4]={0,0,0,0x0a};
   4          /*////////////////
   5          注意以下方法适用于P1.0接SEG1(接口5），P1.5接SEG6（接口10），如果反过来，那么calSEG函数中最后的位颠倒运算可
             -以取消
   6          *//////////////
   7          
   8          
   9          void calSEG(int n)
  10          {
  11   1              uchar digit[2];
  12   1              uchar i,j,old,new;
  13   1              uchar lcdCode[]={0x77,0x14,0x5b,0x5d,0x3c,0x6d,0x6f,0x54,0x7f,0x7d};
  14   1              uchar units,tens;
  15   1              for(i=0;i<4;i++)
  16   1              {
  17   2                      seg[i]=0;
  18   2              }
  19   1              seg[3]=0x0a;
  20   1              if(n<0)
  21   1              {
  22   2                      seg[1]=0x20;
  23   2                      n=-n;
  24   2              }
  25   1              if(n>99)
  26   1              {
  27   2                      seg[0]=0x0;
  28   2                      seg[1]=0x0;
  29   2                      seg[2]=0x0;
  30   2                      seg[3]=0x2a;
  31   2              }
  32   1              else
  33   1              {
  34   2                      digit[0]=n%10;
  35   2                      digit[1]=(n/10)%10;
  36   2                      tens=lcdCode[digit[1]];
  37   2                      units=lcdCode[digit[0]];
  38   2                      seg[0]|=(tens&0x03)<<2  |       (units&0x03);
  39   2                      seg[1]|=(tens&0x0c)             |       (units&0x0c)>>2;
  40   2                      seg[2]|=(tens&0x30)>>2  |       (units&0x30)>>4;
  41   2                      seg[3]|=(tens&0xc0)>>4  |       (units&0xc0)>>6;
  42   2              }
  43   1              //*/取反操作，适用于P1.0接SEG1(接口5），P1.5接SEG6（接口10），如果反过来，那么位颠倒运算可以取消
  44   1              for(i=0;i<4;i++)
  45   1              {
  46   2                      old = seg[i];
  47   2                      new=0;
  48   2                      for(j=0;j<6;j++)
  49   2                      {
  50   3                              new<<=1;
  51   3                              if((old&0x01)==0x01)
  52   3                                      new |= 0x01;
  53   3                              old >>=1;
  54   3                      }
C51 COMPILER V8.06   LCD                                                                   01/17/2018 09:09:21 PAGE 2   

  55   2              }
  56   1      }
  57          
  58          
  59          //*
  60          void lcdShow(int n)
  61          {
  62   1              uchar i,j;
  63   1              uchar highSet[4]={0x0e,0x0d,0x0b,0x07};
  64   1              uchar lowSet[4]={0x01,0x02,0x04,0x08};
  65   1              j=10;
  66   1              calSEG(n);
  67   1              while(j--)
  68   1              {
  69   2                      for(i=0;i<4;i++)
  70   2                      {
  71   3                              P3M1=0x0f;
  72   3                              P3M0=0x00;
  73   3                              P1=seg[i];
  74   3                              P3M1=highSet[i];
  75   3                              P3M0=lowSet[i];
  76   3                              P3=~(0x01<<i);
  77   3                              DelayNms(2);
  78   3                              P3=~P3;
  79   3                              P1=~P1;
  80   3                              DelayNms(2);
  81   3                      }       
  82   2              }
  83   1      
  84   1              
  85   1      }
  86          //*/
  87          /*
  88          void lcdShow(int n)
  89          {
  90                  uchar i,j;
  91                  uchar highSet[4]={0x0e,0x0d,0x0b,0x07};
  92                  uchar lowSet[4]={0x01,0x02,0x04,0x08};
  93                  j=10;
  94                  seg[0]=0x04;
  95                  seg[1]=0x0d;
  96                  seg[2]=0x09;
  97                  seg[3]=0x24;
  98                  
  99                  while(j--)
 100                  {
 101                          for(i=0;i<4;i++)
 102                          {
 103                                  P1=seg[i];
 104                                  P3M1=highSet[i];
 105                                  P3M0=lowSet[i];
 106                                  P3=~(0x01<<i);
 107                                  DelayNms(2);
 108                                  P3=~P3;
 109                                  P1=~P1;
 110                                  DelayNms(2);
 111                          }
 112                  }
 113          
 114          }
 115          //*/

C51 COMPILER V8.06   LCD                                                                   01/17/2018 09:09:21 PAGE 3   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    354    ----
   CONSTANT SIZE    =     18    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4      26
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
